---
layout : single
title : "ì¡°ì´ìŠ¤í‹±"
categories:
  - PoliceAndThief
tags:
  - [Unity, PoliceAndThief, Joystick]

toc: true
toc_sticky: true

Date: 2022-10-14
published: true
---

# ğŸ“Œ Joystick

ëª¨ë°”ì¼ ê²Œì„ì€ ëŒ€ë¶€ë¶„ ì¡°ì´ìŠ¤í‹±ì„ ì´ìš©í•´ ìºë¦­í„°ë¥¼ ì´ë™ì‹œí‚¨ë‹¤.

ê°„ë‹¨í•œ ì¡°ì´ìŠ¤í‹± ì—ì…‹ì„ ì´ìš©í•´ ì´ë¥¼ êµ¬í˜„í•´ë³´ì.

## ğŸ“ Asset

**Nice Touch** ë¼ëŠ” ìœ ë£Œì—ì…‹ì„ ì‚¬ìš©í–ˆë‹¤.

Unity Live ë¥¼ ë³´ê³  ê³µì§œë¡œ ë°›ì•˜ë˜ ì—ì…‹ì´ë¼ ì‚¬ìš©í•´ë³´ì•˜ë‹¤.

![nicetouch](https://user-images.githubusercontent.com/87271529/195623498-761286b9-980d-4ea0-8974-31d37bb183bb.png)

## ğŸ“ ì›ë¦¬

Top View ê²Œì„ì—ì„œ ì¡°ì´ìŠ¤í‹±ì€ íšŒì „ê³¼ ì›€ì§ì„ì„ ë‹´ë‹¹í•œë‹¤.

í˜„ì¬ ì´ ì—ì…‹ì— ì¡´ì¬í•˜ëŠ” ì¡°ì´ìŠ¤í‹±ì€ MMTouchJoystick í´ë˜ìŠ¤ê°€ ì¡´ì¬í•œë‹¤.

```cs
public class MMTouchJoystick
{
  public Vector2 _joystickValue;
}
```

ì´ í´ë˜ìŠ¤ì—ëŠ” JoystickValue ë¼ëŠ” Vector2 ê°€ ì¡´ì¬í•˜ë©°

ì´ëŠ” Joystick ì´ ì›€ì§ì¼ ë•Œ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€í•˜ëŠ” ê°’ì´ë‹¤.

í•´ë‹¹ ê°’ì„ í† ëŒ€ë¡œ ê°€ê³ ì í•˜ëŠ” ë°©í–¥ì„ ë°”ë¼ë´„ê³¼ ë™ì‹œì— ì›€ì§ì¸ë‹¤.

ì´ ê²Œì„ì˜ ìºë¦­í„°ì—ëŠ” Rigidbody ê°€ ë‹¬ë ¤ìˆê¸°ì— ì›€ì§ì„ì€ Rigidbody ë¡œ, íšŒì „ì€ rotation ì„ í†µí•´ êµ¬í˜„í•´ë³´ì.

### ğŸ“‹ Code

PlayerController

```cs
private float _horizontal;
private float _vertical;
private float _angle;

// ìˆ˜í‰, ìˆ˜ì§, ê°ë„ ë³€ìˆ˜ ì±„ì›Œì£¼ê¸°
public void Movement(Vector2 move)
{
  _horizontal = move.x;
  _vertical = move.y;
  // í˜„ì¬ ì¡°ì´ìŠ¤í‹±ì˜ ê°ë„ (ì• : 0 , ì¢Œ : -90 , ë’¤ : -180 , ìš° : 90)
  _angle = Mathf.Atan2(_horizontal, _vertical) * Mathf.Rad2Deg;
	if(_angle < 0)
  {
    _angle += 360;
  }
}

// Movement ë©”ì†Œë“œë¥¼ í†µí•´ ì¡°ì´ìŠ¤í‹±ì—ì„œ ë°›ì€ ê°’ì„ í† ëŒ€ë¡œ _angle ìˆ˜ì •
private void Update()
{
  // Photon ì„ í†µí•´ ë‚´ ìºë¦­í„°ë§Œ ì›€ì§ì´ê²Œ ë§Œë“¤ê¸°
  if(_pv.IsMine)
  {
    if(_joyStick._joystickValue != Vector2.zero) {
      Movement(_joyStick._joystickValue);
    } else {
			Movement(Vector2.zero);
		}
  }
}

// ì›€ì§ì„
private void FixedUpdate()
{
  if(_pv.IsMine)
  {
    Vector3 movement = new Vector3(_horizontal, 0, _vertical) * _walkSpeed * Time.fixedDeltaTime;
		
    // íšŒì „ì‹œì¼œì£¼ê¸°
    if(_angle != 0)
    {
      float cur = this.transform.eulerAngles.y;
      float tar = _angle;
      float yrot = Mathf.Lerp(cur, tar, 10) % 360;
      transform.eulerAngles = new Vector3(transform.eulerAngles.x, yrot, transform.eulerAngles.z);
    }
    // ê°’ì´ ì¡´ì¬í•œë‹¤ë©´ ì›€ì§ì´ê¸°
    if(movement.sqrMagnitude != 0)
    {
      _rb.MovePosition(_rb.position + movement);
    }
  }
}
```

### ğŸ’» Execute

![212](https://user-images.githubusercontent.com/87271529/195641577-569ea6ea-3ddb-4f36-b265-6746167d21d2.gif)
